<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SIFTed | Guides</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="noise"></div>
    {% from "_components.html" import site_nav %}
    {{ site_nav("guides") }}

    <header class="hero compact">
      <div class="hero-text">
        <p class="eyebrow">Guides</p>
        <h1>Workflow playbooks</h1>
        <p class="lead">Start with a hypothesis, or start with the artifact.</p>
      </div>
    </header>

    <div class="guides-layout">
      <main class="guides-main">
        <section class="card block guides-controls">
          <div class="guides-controls-row">
            <div class="guides-search">
              <input
                type="text"
                id="guideSearch"
                placeholder="Search guides..."
                autocomplete="off"
              />
            </div>
            <div class="tab-row" role="tablist" aria-label="Guide modes">
              <button class="tab-button active" type="button" data-tab="hypothesis" role="tab" aria-selected="true">
                Hypothesis driven
              </button>
              <button class="tab-button" type="button" data-tab="artifact" role="tab" aria-selected="false">
                Artifact driven
              </button>
            </div>
          </div>
          <p class="helper">
            Hypothesis-driven: prove or disprove a claim. Artifact-driven: learn what evidence suggests.
          </p>
          <div class="guides-controls-meta">
            <span class="guides-count" id="guideCount">0 guides</span>
            <div class="guides-actions">
              <button class="ghost" id="clearGuideSearch" type="button" hidden>Clear search</button>
            </div>
          </div>
        </section>

        <p class="guides-empty" id="guideEmpty" hidden>No guides match that search. Try a different keyword.</p>

        <section class="tool-grid tab-panel" data-tab-panel="hypothesis">
          <article class="guide-card" data-category="execution" data-keywords="phishing email attachment macro office document initial access outlook spam malicious link">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="execution"></span>
                <div>
                  <h2>I think a phishing email led to compromise</h2>
                  <p class="helper">Trace the chain from email delivery to payload execution.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">A user may have received a phishing email and interacted with a malicious attachment or link, leading to code execution. Your goal is to establish the chain from email delivery through user interaction to payload execution.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>Did the user open a suspicious attachment or click a link near the suspected timeframe?</li>
                    <li>Was code execution triggered by the interaction (macro, script, executable)?</li>
                    <li>What is the timeline from email arrival to first signs of compromise?</li>
                    <li>Could this be a legitimate document or a false positive from security tooling?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Email and delivery artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="browser">Browser history</span> may show webmail access or clicked links from the email.</li>
                    <li><span class="artifact-link" data-artifact="recentdocs">RecentDocs</span> and <span class="artifact-link" data-artifact="lnk">LNK files</span> may reveal recently opened suspicious documents.</li>
                    <li><span class="artifact-link" data-artifact="outlook">Outlook attachment cache</span> or temp files in the user profile may contain the payload.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Execution artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show Office apps, wscript.exe, powershell.exe, or cmd.exe execution times.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> may contain encoded commands or suspicious script blocks.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> (4688) may reveal child processes spawned by Office applications.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">File artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="ads">Zone.Identifier</span> may prove the file was downloaded from the internet.</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may show document creation time and location.</li>
                    <li><span class="artifact-link" data-artifact="jumplists">Jump Lists</span> for Office apps may show the opened document.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="defender">Windows Defender</span> detections around the same timeframe.</li>
                    <li>Parent-child process relationships linking Office to script interpreters.</li>
                    <li>Network connections initiated shortly after document open.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>The email itself may be deleted—focus on artifacts of interaction, not the email.</li>
                    <li>Macro-enabled documents are not inherently malicious; many are legitimate.</li>
                    <li>Timestamp gaps between email tools can create misleading timelines.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Email content and headers may not be available without mail server access.</li>
                    <li>Opening a document does not prove a payload executed successfully.</li>
                    <li>Webmail-based phishing may leave fewer local artifacts than desktop clients.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If the chain from email to execution is established, pivot to post-exploitation analysis. If the user opened the document but no execution occurred, the attack may have failed. If no interaction artifacts exist, reconsider the delivery vector.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="exfil" data-keywords="data exfiltration staging theft usb cloud upload archive zip rar compression transfer leak">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="exfil"></span>
                <div>
                  <h2>I think data was exfiltrated</h2>
                  <p class="helper">Investigate staging, archiving, and data transfer activity.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">Sensitive data may have been collected, staged, and transferred out of the environment. Your goal is to identify evidence of data collection, staging or archiving activity, and the transfer mechanism used.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>Was data collected or staged in unusual locations or archive files?</li>
                    <li>What transfer mechanism was used—USB, cloud storage, network, or email?</li>
                    <li>Does the volume or type of data suggest targeted collection or bulk theft?</li>
                    <li>Could this be legitimate backup, file sharing, or work-from-home activity?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Staging and archiving artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show execution of archiving tools (7z.exe, rar.exe, zip utilities).</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may reveal recently created archives in temp or user folders.</li>
                    <li><span class="artifact-link" data-artifact="shellbags">Shellbags</span> may indicate browsing of sensitive directories.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Transfer artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="usb">USB device history</span> may show removable media connections near the timeframe.</li>
                    <li><span class="artifact-link" data-artifact="browser">Browser history</span> may reveal cloud storage uploads (Drive, Dropbox, WeTransfer).</li>
                    <li><span class="artifact-link" data-artifact="srum">SRUM</span> may show network usage spikes by specific applications.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">File and access artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="lnk">LNK files</span> may point to archive files or staging folders.</li>
                    <li><span class="artifact-link" data-artifact="recyclebin">Recycle Bin</span> may contain deleted archives or staging evidence.</li>
                    <li><span class="artifact-link" data-artifact="recentdocs">RecentDocs</span> may show access to sensitive files before staging.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li>Timeline alignment between file access, archive creation, and transfer activity.</li>
                    <li>Network or proxy logs showing large outbound transfers.</li>
                    <li>DLP alerts or email gateway logs for the same timeframe.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Archive creation is routine—focus on what was archived and where it went.</li>
                    <li>Cloud sync tools create continuous uploads that may mask exfiltration.</li>
                    <li>USB insertion does not prove data was copied to it.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Deleted staging artifacts may only be recoverable from Volume Shadow Copies.</li>
                    <li>Encrypted archives hide their contents from forensic review.</li>
                    <li>Network-based exfiltration may leave no endpoint artifacts.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If staging and transfer are confirmed, document the timeline and data involved. If staging exists but no transfer is found, the exfiltration may have been interrupted or used a channel not examined. If no staging evidence exists, reconsider whether data loss occurred through a different method.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="lateral" data-keywords="lateral movement rdp psexec wmi remote access pivot network smb admin share">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="lateral"></span>
                <div>
                  <h2>I think there was lateral movement</h2>
                  <p class="helper">Investigate remote access between systems.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">An attacker may have moved from one system to another within the environment using remote access techniques. Your goal is to identify evidence of inbound or outbound remote connections and determine whether they were authorized.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>Was this host accessed remotely from another internal system?</li>
                    <li>Did this host initiate connections to other internal systems?</li>
                    <li>What technique was used—RDP, PsExec, WMI, SMB, or other?</li>
                    <li>Could this be legitimate administrative activity or IT operations?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Inbound access (this host was targeted)</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 4624 Type 3 (network) and Type 10 (RDP) may show source IPs and accounts.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 7045 (service install) or 4698 (task creation) may indicate remote execution.</li>
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show PsExec, WMIC, or remote admin tool execution.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Outbound access (this host was the source)</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="rdp">RDP artifacts</span> in the registry may show outbound connection history.</li>
                    <li><span class="artifact-link" data-artifact="shellbags">Shellbags</span> may reveal network share browsing via UNC paths.</li>
                    <li><span class="artifact-link" data-artifact="lnk">LNK files</span> may point to files on remote systems.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Execution artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="bam">BAM/DAM</span> may show remote tool execution times.</li>
                    <li><span class="artifact-link" data-artifact="wmi">WMI subscriptions</span> may indicate remote execution persistence.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> may contain remote execution commands (Invoke-Command, Enter-PSSession).</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li>Matching timestamps on source and destination systems for the same connection.</li>
                    <li>Firewall or network logs showing connections between internal hosts.</li>
                    <li>Credential theft artifacts preceding the lateral movement activity.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Type 3 logons are extremely common—filter by source IP and account context.</li>
                    <li>IT tools like SCCM and monitoring agents generate legitimate remote connections.</li>
                    <li>Single-host analysis misses half the story—correlate across source and destination.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Network logons may not identify the technique used (RDP vs SMB vs WMI).</li>
                    <li>Outbound connection artifacts require the source host to be analyzed.</li>
                    <li>Pass-the-hash and token manipulation leave fewer artifacts than password-based access.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If lateral movement is confirmed, map the full path across systems and identify the technique. If only one direction is visible, obtain artifacts from the other host. If no remote access evidence exists, reconsider whether movement occurred via a different method or time window.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="execution" data-keywords="malicious download drive-by browser exploit kit dropper initial access download zone identifier motw">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="execution"></span>
                <div>
                  <h2>I think the user downloaded something malicious</h2>
                  <p class="helper">Trace from download source to disk to execution.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">A user may have downloaded a malicious file from the internet and executed it. Your goal is to establish the chain from download source through file creation to execution and any subsequent activity.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>What was the source URL and how did the user reach it?</li>
                    <li>Was the downloaded file executed, and by what method (user action or automatic)?</li>
                    <li>Did security controls (Defender, SmartScreen) intervene or alert?</li>
                    <li>Could this be a legitimate download that triggered a false positive?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Download artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="browser">Browser history</span> and download records may reveal the source URL.</li>
                    <li><span class="artifact-link" data-artifact="ads">Zone.Identifier</span> ADS proves the file originated from the internet (Mark of the Web).</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may show file creation time and location in Downloads or temp folders.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Execution artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show the downloaded file and any child processes it spawned.</li>
                    <li><span class="artifact-link" data-artifact="userassist">UserAssist</span> may indicate the user double-clicked the file.</li>
                    <li><span class="artifact-link" data-artifact="lnk">LNK files</span> may be created when the downloaded file was opened.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Security artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="defender">Windows Defender</span> may show detections or quarantine actions.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> may contain SmartScreen or AppLocker decisions.</li>
                    <li><span class="artifact-link" data-artifact="amcache">Amcache</span> may provide file hash for threat intelligence lookup.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="bits">BITS jobs</span> if the download used background transfer.</li>
                    <li>Timeline alignment between browser activity, file creation, and execution.</li>
                    <li>Network connections initiated by the downloaded file after execution.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Zone.Identifier can be removed manually or by certain extraction tools.</li>
                    <li>Browser history may be cleared or use private browsing mode.</li>
                    <li>File may have been renamed or moved after download.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Download via non-browser methods (curl, PowerShell) may not appear in browser history.</li>
                    <li>File presence does not prove execution occurred.</li>
                    <li>Defender quarantine may have removed the file before execution.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If download and execution are confirmed, pivot to post-exploitation analysis. If the file was downloaded but not executed, the threat may have been blocked or the user did not interact. If no download artifacts exist, consider alternative delivery methods.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="lateral" data-keywords="credential theft mimikatz lsass dump password hash ntlm kerberos pass-the-hash secretsdump">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="lateral"></span>
                <div>
                  <h2>I think credentials were stolen</h2>
                  <p class="helper">Investigate whether credentials were extracted and reused.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">Credentials may have been extracted from memory, storage, or network traffic. Your goal is to determine whether credential access occurred and whether those credentials were subsequently used for unauthorized activity.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>Was LSASS or another credential store accessed by an unexpected process?</li>
                    <li>Are there artifacts of known credential dumping tools or techniques?</li>
                    <li>Do authentication logs show credential use from unexpected sources or times?</li>
                    <li>Could this be legitimate administrative activity or authorized security testing?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Process and memory access</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="sysmon">Sysmon</span> Event ID 10 may show LSASS access by unexpected processes.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> may reveal credential-related cmdlets or encoded commands.</li>
                    <li>Process creation logs (4688) may show dumping tools or suspicious parent-child relationships.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Tool artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show execution of mimikatz, procdump, comsvcs.dll, or renamed variants.</li>
                    <li><span class="artifact-link" data-artifact="amcache">Amcache</span> may contain metadata or hashes matching known credential tools.</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may reveal .dmp files or suspicious executables in temp directories.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Authentication artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 4624/4625 may show pass-the-hash (NTLM Type 3) or anomalous Kerberos activity.</li>
                    <li>Logon events from unexpected source IPs, workstations, or at unusual times.</li>
                    <li>Kerberos ticket requests (4768/4769) for sensitive accounts from unexpected hosts.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="defender">Windows Defender</span> detections for credential theft tools or behaviors.</li>
                    <li>Timeline alignment between LSASS access and subsequent lateral movement.</li>
                    <li>Multiple failed logons followed by success from the same source.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>LSASS access alone is not malicious—many legitimate tools interact with LSASS.</li>
                    <li>Renamed tools evade filename-based detection; focus on behavior and hashes.</li>
                    <li>Pass-the-hash leaves fewer artifacts than password-based authentication.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Credential theft from memory may leave no file artifacts.</li>
                    <li>Without <span class="artifact-link" data-artifact="sysmon">Sysmon</span> or enhanced logging, LSASS access may not be recorded.</li>
                    <li>Successful authentication does not prove the credential was stolen.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If credential access is confirmed, pivot to lateral movement analysis. If tool artifacts exist but no credential use is found, the attack may have been interrupted. If no evidence emerges across process, tool, and authentication artifacts, reassess the hypothesis.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="recovery" data-keywords="anti-forensics timestomping log clearing evidence destruction cover tracks">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="recovery"></span>
                <div>
                  <h2>I need to check for anti-forensics</h2>
                  <p class="helper">Investigate evidence tampering or destruction.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">Evidence may have been intentionally tampered with, deleted, or manipulated to hide activity. Your goal is to identify signs of anti-forensic techniques and recover or work around the gaps they created.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>Are there unexplained gaps in logs or artifacts that should be continuous?</li>
                    <li>Do timestamp patterns suggest manipulation (round numbers, impossible dates)?</li>
                    <li>Were cleanup tools or commands executed?</li>
                    <li>Could gaps be explained by normal log rotation, retention policies, or system issues?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Log clearing artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 1102 (Security) and 104 (System) indicate explicit log clearing.</li>
                    <li>Gaps in normally continuous logs or suspiciously recent log start times may indicate clearing.</li>
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show wevtutil.exe, fsutil.exe, or known cleanup tools.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Timestamp manipulation</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> $SI vs $FN timestamp mismatches may indicate timestomping.</li>
                    <li>Files with creation dates before OS install or perfectly round timestamps suggest manipulation.</li>
                    <li>Timezone inconsistencies across related artifacts may reveal editing.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Deletion artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="recyclebin">Recycle Bin</span> may contain deleted tools or evidence.</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may show deleted file entries with recoverable metadata.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> may contain Clear-EventLog or Remove-Item commands.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="vss">Volume Shadow Copies</span> may contain pre-tampering versions of artifacts.</li>
                    <li>Timeline gaps that align with known malicious activity windows.</li>
                    <li>Multiple anti-forensic indicators pointing to the same timeframe.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Log gaps can result from retention policies, not malice—check normal rotation schedules.</li>
                    <li>$FN timestamps are not always reliable for timestomping detection on all Windows versions.</li>
                    <li>System reinstalls or repairs can create legitimate timestamp anomalies.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Effective anti-forensics may leave no detectable traces.</li>
                    <li>Secure deletion tools can make file recovery impossible.</li>
                    <li>Proving intent to destroy evidence requires corroborating context.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If anti-forensics is confirmed, document the technique and attempt recovery via shadow copies or alternate sources. If gaps exist but no tampering evidence is found, attribute to normal system behavior. Anti-forensics itself is evidence of intent—the attempt to hide may be as significant as what was hidden.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="timeline" data-keywords="initial access patient zero first compromise entry point">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="timeline"></span>
                <div>
                  <h2>I need to identify initial access</h2>
                  <p class="helper">Find patient zero and the entry point.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">The attacker entered the environment through a specific vector at a specific time. Your goal is to identify patient zero, the entry point technique, and the timestamp that anchors the beginning of the intrusion.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>What is the earliest confirmed malicious activity, and what immediately preceded it?</li>
                    <li>Which system was compromised first, and how did access spread from there?</li>
                    <li>What vector was used—phishing, exploit, valid credentials, or supply chain?</li>
                    <li>Could the earliest known activity actually be secondary, with initial access occurring earlier?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Timeline analysis</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="timeline">Timeline</span> analysis working backwards from confirmed malicious activity.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> for the first suspicious logon, process, or service installation.</li>
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> first execution timestamps for malicious binaries.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Common access vectors</div>
                  <ul class="guide-detail-list">
                    <li>Phishing: Email artifacts, <span class="artifact-link" data-artifact="browser">browser history</span>, Office macro execution.</li>
                    <li>Exploitation: Vulnerable service crashes, unexpected child processes, web shell creation.</li>
                    <li>Valid accounts: <span class="artifact-link" data-artifact="rdp">RDP</span>/VPN logons from unusual IPs, times, or geolocations.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">File and network artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> for the first malicious file creation timestamp.</li>
                    <li><span class="artifact-link" data-artifact="ads">Zone.Identifier</span> to identify files downloaded from external sources.</li>
                    <li>Network or proxy logs for the first connection to known-bad infrastructure.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li>Multiple artifact types pointing to the same initial timestamp.</li>
                    <li>Logical progression from initial access to subsequent attacker actions.</li>
                    <li>External threat intelligence matching the observed vector or infrastructure.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>The first detected activity may not be the actual initial access.</li>
                    <li>Attackers may stage dormant access before beginning active operations.</li>
                    <li>Focusing on one host may miss initial access that occurred on another system.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Log retention may not extend back to actual initial access.</li>
                    <li>Supply chain or trusted relationship compromises may leave minimal artifacts.</li>
                    <li>Anti-forensics may have targeted earliest evidence specifically.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If initial access is identified with corroborating evidence, document the vector, timestamp, and patient zero system. If the earliest evidence feels incomplete, look for earlier dormant access. Initial access sets the dwell time clock—finding it anchors your entire timeline.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="recovery" data-keywords="ransomware encryption extortion ransom note crypto locker lockbit blackcat conti ryuk">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="recovery"></span>
                <div>
                  <h2>I think this is a ransomware attack</h2>
                  <p class="helper">Identify the variant, trace encryption scope, and find initial access.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">Ransomware may have encrypted data on one or more systems. Your goal is to identify the ransomware variant, determine the scope of encryption, trace initial access, and identify any data exfiltration that preceded encryption.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>What ransomware variant is this, and are decryption options available?</li>
                    <li>When did encryption begin, and how many systems were affected?</li>
                    <li>How did the attacker gain initial access, and how long was the dwell time?</li>
                    <li>Was data exfiltrated before encryption (double extortion)?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Variant identification</div>
                  <ul class="guide-detail-list">
                    <li>Ransom notes (README.txt, DECRYPT.html) can be checked against ID Ransomware or No More Ransom.</li>
                    <li><span class="artifact-link" data-artifact="defender">Windows Defender</span> detection names may identify the ransomware family.</li>
                    <li><span class="artifact-link" data-artifact="amcache">Amcache</span> may provide hashes for threat intelligence lookup.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Encryption scope and timeline</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> modification times on encrypted files establish the encryption window.</li>
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show vssadmin.exe, bcdedit.exe, wbadmin.exe used to delete recovery options.</li>
                    <li><span class="artifact-link" data-artifact="shellbags">Shellbags</span> and <span class="artifact-link" data-artifact="lnk">LNK files</span> may show network share access for lateral encryption.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Initial access and dwell time</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show Cobalt Strike, PsExec, or RMM tools days or weeks before encryption.</li>
                    <li><span class="artifact-link" data-artifact="rdp">RDP artifacts</span> may reveal unauthorized remote access.</li>
                    <li><span class="artifact-link" data-artifact="srum">SRUM</span> network spikes before encryption may indicate data staging and exfiltration.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 7045 (service install) around encryption start time.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> for encoded commands or security-disabling scripts.</li>
                    <li><span class="artifact-link" data-artifact="vss">Volume Shadow Copy</span> deletion timing aligning with encryption.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Encryption timestamp is not initial access—attackers often dwell for days or weeks first.</li>
                    <li>Focusing only on encryption misses pre-encryption reconnaissance and exfiltration.</li>
                    <li>Multiple ransomware variants exist; encrypted extension alone may not identify the family.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Ransomware often deletes its own binary after encryption completes.</li>
                    <li>Volume Shadow Copies are typically deleted, limiting recovery options.</li>
                    <li>Double extortion (data theft) may have occurred even if not immediately apparent.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">Once variant, scope, initial access, and exfiltration status are determined, the investigation can inform recovery and negotiation decisions. Modern ransomware often involves data theft—always check for exfiltration evidence to understand the full scope of the incident.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="lateral" data-keywords="command control c2 beacon callback implant cobalt strike metasploit covenant sliver">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="lateral"></span>
                <div>
                  <h2>I suspect command and control activity</h2>
                  <p class="helper">Investigate beaconing, C2 infrastructure, and attacker communications.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">A compromised system may be communicating with attacker-controlled infrastructure. Your goal is to identify C2 channels, understand the communication patterns, and determine what capabilities the attacker has maintained.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>What process or mechanism is generating the C2 traffic?</li>
                    <li>What infrastructure is the implant communicating with?</li>
                    <li>Is the beaconing pattern regular (automated) or irregular (interactive)?</li>
                    <li>Could this traffic be legitimate software phoning home or updating?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Network artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="srum">SRUM</span> may show processes with sustained network activity to unusual destinations.</li>
                    <li><span class="artifact-link" data-artifact="browser">Browser history</span> and DNS cache may reveal suspicious domains (DGA patterns, newly registered).</li>
                    <li>Network logs with regular interval connections suggest automated beaconing.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Host artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> may show known C2 frameworks or renamed variants.</li>
                    <li><span class="artifact-link" data-artifact="powershell">PowerShell logs</span> may contain encoded commands, download cradles, or Invoke-Expression.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> (4688) may reveal unusual parent-child process relationships.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Evasion techniques to consider</div>
                  <ul class="guide-detail-list">
                    <li>Domain fronting: Traffic appears to go to legitimate CDN domains.</li>
                    <li>DNS tunneling: Long, encoded DNS queries to attacker-controlled domains.</li>
                    <li>Living-off-the-land: Built-in tools (certutil, bitsadmin) used for communications.</li>
                    <li>Cloud C2: Legitimate services (Slack, Teams, GitHub, cloud storage) as channels.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="bits">BITS jobs</span> for persistent download or communication tasks.</li>
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> for suspicious DLLs or executables in temp folders.</li>
                    <li>Memory analysis for in-memory implants that don't touch disk.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Legitimate software beacons regularly (updates, telemetry)—verify the process.</li>
                    <li>C2 over HTTPS to cloud providers looks like normal traffic without decryption.</li>
                    <li>In-memory implants may leave no file artifacts—process memory is key evidence.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Encrypted C2 traffic content is not visible without TLS interception.</li>
                    <li>Domain fronting and CDN abuse make blocking difficult without breaking legitimate services.</li>
                    <li>Fileless malware may only be detectable through memory analysis.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If C2 is confirmed, identify all affected hosts and block the infrastructure. If beaconing stops after containment, the channel is cut. C2 is the attacker's lifeline—finding and blocking it removes their access and forces them to re-establish presence.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="persistence" data-keywords="persistence backdoor autorun startup scheduled task service registry implant maintain access">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="persistence"></span>
                <div>
                  <h2>I think persistence was installed</h2>
                  <p class="helper">Investigate whether unauthorized auto-start entries were added.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">Something may have configured itself to survive reboot. Your goal is to identify unexpected auto-start entries and determine whether they correlate with unauthorized activity—or can be explained by legitimate software.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>When was this entry created, and does that timing align with other suspicious activity?</li>
                    <li>Is the referenced executable present, and can its purpose be explained?</li>
                    <li>Could this be legitimate software, IT policy, or user configuration?</li>
                    <li>What corroborating evidence would I expect if this is malicious?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Registry artifacts (Windows)</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="runkeys">Run/RunOnce keys</span> in HKLM and HKCU may indicate auto-start configuration.</li>
                    <li><span class="artifact-link" data-artifact="services">Services</span> in SYSTEM hive may reveal unexpected service installations.</li>
                    <li>IFEO debugger entries, Winlogon keys, and AppInit_DLLs may indicate hijacking.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Task and service artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="scheduledtasks">Scheduled Tasks</span> configured for boot, login, or idle triggers.</li>
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> 7045 (service install) and 4698 (task creation) may show when entries were added.</li>
                    <li>WMI subscriptions and startup folders for additional auto-start vectors.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">File and application artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> may show recently created executables in system paths.</li>
                    <li>DLL search-order hijacking, Office add-ins, browser extensions, COM objects.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Linux artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="cron">Cron</span>, <span class="artifact-link" data-artifact="systemdunits">systemd units</span>, <span class="artifact-link" data-artifact="sshkeys">authorized_keys</span>, <span class="artifact-link" data-artifact="envfiles">shell profiles</span>.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> showing payload execution at boot.</li>
                    <li><span class="artifact-link" data-artifact="amcache">Amcache</span>/<span class="artifact-link" data-artifact="shimcache">ShimCache</span> for file metadata and presence.</li>
                    <li>Timeline alignment with initial access or lateral movement.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Unfamiliar does not mean malicious—research before concluding.</li>
                    <li>One mechanism found does not mean others don't exist.</li>
                    <li>Registry key presence does not prove execution.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Legitimate software uses identical persistence mechanisms.</li>
                    <li>Absence of artifacts does not mean persistence was never present.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If flagged entries can be explained, document and move on. If corroborated, expand scope. If nothing found, revisit the hypothesis.</p>
                </div>
              </div>
            </div>
          </article>

          <article class="guide-card" data-category="exfil" data-keywords="insider threat employee misconduct policy violation data theft sabotage fraud abuse">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="exfil"></span>
                <div>
                  <h2>I'm investigating insider threat</h2>
                  <p class="helper">Investigate employee misconduct, data theft, or policy violations.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-group">
                <div class="guide-group-header">Framing</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">The hypothesis</div>
                  <p class="guide-detail-text">An employee or contractor may have misused their access for data theft, policy violation, or other misconduct. Your goal is to establish what the user accessed, what actions they took, and whether data was exfiltrated—while preserving evidence for potential HR or legal action.</p>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Key questions</div>
                  <ul class="guide-detail-list">
                    <li>What data or systems did the user access beyond their normal role?</li>
                    <li>Was data collected, staged, or transferred outside the organization?</li>
                    <li>Does the activity timeline correlate with resignation notice or other red flags?</li>
                    <li>Could this activity be explained by legitimate job duties or a misunderstanding?</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Evidence</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">User activity timeline</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="eventlogs">Event logs</span> (4624, 4634, 4647) establish logon sessions and times.</li>
                    <li><span class="artifact-link" data-artifact="userassist">UserAssist</span> and <span class="artifact-link" data-artifact="prefetch">Prefetch</span> reveal application usage patterns.</li>
                    <li>After-hours activity or activity during leave periods may indicate intent.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Data access artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="shellbags">Shellbags</span> and <span class="artifact-link" data-artifact="lnk">LNK files</span> reveal folders browsed, especially sensitive areas.</li>
                    <li><span class="artifact-link" data-artifact="recentdocs">RecentDocs</span> and <span class="artifact-link" data-artifact="jumplists">Jump Lists</span> show files accessed.</li>
                    <li>Bulk file access patterns (many files in short timeframe) suggest collection activity.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Exfiltration artifacts</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="usb">USB device history</span> for removable media connections.</li>
                    <li><span class="artifact-link" data-artifact="browser">Browser history</span> for personal email, cloud storage, or file sharing sites.</li>
                    <li><span class="artifact-link" data-artifact="srum">SRUM</span> for unusual network upload volumes by application.</li>
                  </ul>
                </div>
              </div>
              <div class="guide-group">
                <div class="guide-group-header">Analysis</div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">Corroboration</div>
                  <ul class="guide-detail-list">
                    <li><span class="artifact-link" data-artifact="mft">$MFT</span> for file copy operations (files created then quickly deleted).</li>
                    <li><span class="artifact-link" data-artifact="recyclebin">Recycle Bin</span> for deleted staging evidence.</li>
                    <li>Email logs for forwarding rules or attachments sent externally.</li>
                    <li>DLP alerts if such systems are deployed.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Pitfalls</div>
                  <ul class="guide-detail-list">
                    <li>Accessing files is not proof of exfiltration—establish the transfer mechanism.</li>
                    <li>USB insertion does not prove data was copied—look for file copy artifacts.</li>
                    <li>Activity outside normal hours may have legitimate explanations.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label warning">Limitations</div>
                  <ul class="guide-detail-list">
                    <li>Personal devices used for exfiltration may not leave endpoint artifacts.</li>
                    <li>Cloud sync to personal accounts may bypass DLP and leave minimal traces.</li>
                    <li>Proving intent requires context beyond technical artifacts alone.</li>
                  </ul>
                </div>
                <div class="guide-detail-section">
                  <div class="guide-detail-label">When to stop</div>
                  <p class="guide-detail-text">If misconduct is established, preserve evidence with documented chain of custody. Coordinate with HR and Legal before any confrontation. Insider investigations require different handling than external breaches—premature action can compromise both the investigation and legal options.</p>
                </div>
              </div>
            </div>
          </article>
        </section>

        <section class="tool-grid tab-panel" data-tab-panel="artifact" hidden>
          <article class="guide-card" data-category="memory" data-keywords="memory dump ram volatility processes network connections injection linux windows">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="memory"></span>
                <div>
                  <h2>I have a memory dump</h2>
                  <p class="helper">Extract processes, network state, and injected code.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <div class="guide-header">
                  <h3>Volatility analysis</h3>
                  <a class="ghost" href="/volatility">Open Volatility</a>
                </div>
                <ol class="guide-list">
                  <li>Identify the OS first using <code>banners.Banners</code> or by examining the dump source.</li>
                  <li>Run the appropriate info plugin (<code>windows.info</code> or <code>linux.bash</code>) to validate.</li>
                  <li>List processes and check for unusual parent-child relationships or hidden processes.</li>
                  <li>Examine network connections for suspicious remote IPs or unexpected listeners.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Windows plugins</h3>
                <ul class="guide-list">
                  <li><code>windows.pslist</code> / <code>windows.pstree</code> - Process listing and hierarchy.</li>
                  <li><code>windows.netscan</code> - Active and closed network connections.</li>
                  <li><code>windows.malfind</code> - Detect injected or suspicious memory regions.</li>
                  <li><code>windows.cmdline</code> - Process command line arguments.</li>
                  <li><code>windows.dlllist</code> / <code>windows.handles</code> - Loaded modules and open handles.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Linux plugins</h3>
                <ul class="guide-list">
                  <li><code>linux.pslist</code> / <code>linux.pstree</code> - Process listing and hierarchy.</li>
                  <li><code>linux.sockstat</code> - Open network sockets.</li>
                  <li><code>linux.bash</code> - Bash command history from memory.</li>
                  <li><code>linux.elfs</code> - Enumerate ELF binaries in process memory.</li>
                  <li><code>linux.lsof</code> - Open files per process.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Key questions to answer</h3>
                <ul class="guide-list">
                  <li>Are there unexpected processes or unusual parent-child relationships?</li>
                  <li>Do any processes have network connections to suspicious IPs?</li>
                  <li>Are there injected code regions or hidden processes?</li>
                  <li>What command lines or arguments were used to launch processes?</li>
                </ul>
              </div>
              <p class="helper">Memory analysis captures running state. It complements but doesn't replace disk forensics.</p>
            </div>
          </article>

          <article class="guide-card" data-category="timeline" data-keywords="event logs evtx security system logon process creation">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="timeline"></span>
                <div>
                  <h2>I have Windows Event Logs</h2>
                  <p class="helper">Extract logons, process execution, and service activity.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Critical Event IDs</h3>
                <ul class="guide-list">
                  <li><strong>Security 4624/4625</strong> - Successful/failed logons with type and source.</li>
                  <li><strong>Security 4688</strong> - Process creation (if enabled) with command line.</li>
                  <li><strong>Security 4672</strong> - Special privileges assigned (admin logon).</li>
                  <li><strong>System 7045</strong> - New service installed.</li>
                  <li><strong>Security 1102</strong> - Audit log cleared (anti-forensics indicator).</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Logon type reference</h3>
                <ul class="guide-list">
                  <li><strong>Type 2</strong> - Interactive (local keyboard).</li>
                  <li><strong>Type 3</strong> - Network (file share, PsExec).</li>
                  <li><strong>Type 4</strong> - Batch (scheduled task).</li>
                  <li><strong>Type 5</strong> - Service.</li>
                  <li><strong>Type 10</strong> - RemoteInteractive (RDP).</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Additional valuable logs</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="powershell">PowerShell/Operational</span> - Script block logging (4104).</li>
                  <li>TerminalServices-LocalSessionManager - RDP session details.</li>
                  <li>TaskScheduler/Operational - Scheduled task execution.</li>
                  <li><span class="artifact-link" data-artifact="defender">Windows Defender/Operational</span> - Detections and actions.</li>
                </ul>
              </div>
              <p class="helper">Filter by time window first, then pivot on user accounts or source IPs.</p>
            </div>
          </article>

          <article class="guide-card" data-category="execution" data-keywords="prefetch pf execution run count timestamp">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="execution"></span>
                <div>
                  <h2>I have Prefetch files</h2>
                  <p class="helper">Confirm execution with timestamps and run counts.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>What <span class="artifact-link" data-artifact="prefetch">Prefetch</span> tells you</h3>
                <ul class="guide-list">
                  <li><strong>Executable name</strong> - The program that ran (first 29 characters).</li>
                  <li><strong>Run count</strong> - How many times it executed.</li>
                  <li><strong>Last run time</strong> - Most recent execution (up to 8 on Win10+).</li>
                  <li><strong>Referenced files</strong> - DLLs and files loaded during first 10 seconds.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Investigative workflow</h3>
                <ol class="guide-list">
                  <li>Parse all .pf files and sort by last execution time.</li>
                  <li>Look for suspicious executable names or tools (psexec, mimikatz variants).</li>
                  <li>Check referenced files for paths indicating staging locations.</li>
                  <li>Correlate timestamps with other artifacts for a complete picture.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Limitations to remember</h3>
                <ul class="guide-list">
                  <li>Prefetch may be disabled on SSDs or by policy.</li>
                  <li>Maximum 1024 .pf files on Win10+; older entries are overwritten.</li>
                  <li>Renamed executables create new Prefetch files.</li>
                </ul>
              </div>
              <p class="helper">Prefetch is strong execution evidence, but absence doesn't prove non-execution.</p>
            </div>
          </article>

          <article class="guide-card" data-category="persistence" data-keywords="registry hive ntuser sam system software">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="persistence"></span>
                <div>
                  <h2>I have registry hives</h2>
                  <p class="helper">Extract persistence, user activity, and system config.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>SYSTEM hive</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="services">Services</span> - Auto-start services and their binaries.</li>
                  <li><span class="artifact-link" data-artifact="shimcache">AppCompatCache</span> - File execution/presence evidence.</li>
                  <li><span class="artifact-link" data-artifact="bam">BAM/DAM</span> - Program execution with timestamps.</li>
                  <li><span class="artifact-link" data-artifact="usb">USB devices</span> - Connected device history.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>NTUSER.DAT (per user)</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="userassist">UserAssist</span> - GUI program launches (ROT13 encoded).</li>
                  <li><span class="artifact-link" data-artifact="recentdocs">RecentDocs</span> - Recently opened files by extension.</li>
                  <li><span class="artifact-link" data-artifact="typedpaths">TypedPaths</span> - Manually typed Explorer paths.</li>
                  <li><span class="artifact-link" data-artifact="runkeys">Run keys</span> - User-level persistence.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>SOFTWARE hive</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="runkeys">Run keys</span> - Machine-level persistence.</li>
                  <li>Installed programs and uninstall entries.</li>
                  <li>Network profiles and connection history.</li>
                </ul>
              </div>
              <p class="helper">Registry analysis complements file system artifacts. Cross-reference timestamps.</p>
            </div>
          </article>

          <article class="guide-card" data-category="recovery" data-keywords="disk image dd e01 ewf raw full forensic linux windows">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="recovery"></span>
                <div>
                  <h2>I have a disk image</h2>
                  <p class="helper">Full forensic analysis starting points.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Triage workflow</h3>
                <ol class="guide-list">
                  <li>Mount the image read-only and verify the hash if available.</li>
                  <li>Identify the OS and filesystem type (NTFS, ext4, etc.).</li>
                  <li>Run <a href="/bulk-extractor">Bulk Extractor</a> with triage preset for quick wins.</li>
                  <li>Build a <span class="artifact-link" data-artifact="timeline">timeline</span> with Plaso to see overall activity.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Windows-specific artifacts</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="mft">$MFT</span> for file creation, modification, and deletion.</li>
                  <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span>, <span class="artifact-link" data-artifact="eventlogs">Event Logs</span>, and Registry hives.</li>
                  <li><span class="artifact-link" data-artifact="recyclebin">Recycle Bin</span> and <span class="artifact-link" data-artifact="vss">Volume Shadow Copies</span>.</li>
                  <li><span class="artifact-link" data-artifact="lnk">LNK files</span>, <span class="artifact-link" data-artifact="jumplists">Jump Lists</span>, and <span class="artifact-link" data-artifact="shellbags">Shellbags</span>.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Linux-specific artifacts</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="authlogs">Auth logs</span>, <span class="artifact-link" data-artifact="syslog">syslog</span>, and <span class="artifact-link" data-artifact="journal">systemd journal</span>.</li>
                  <li><span class="artifact-link" data-artifact="bashhistory">Bash history</span> and <span class="artifact-link" data-artifact="envfiles">environment files</span>.</li>
                  <li><span class="artifact-link" data-artifact="cron">Cron jobs</span> and <span class="artifact-link" data-artifact="systemdunits">systemd units</span>.</li>
                  <li><span class="artifact-link" data-artifact="passwdshadow">User accounts</span> and <span class="artifact-link" data-artifact="sshkeys">SSH keys</span>.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Cross-platform analysis</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="browser">Browser history</span> and downloads (similar paths on both OSes).</li>
                  <li>Run <a href="/foremost">Foremost</a> or <a href="/scalpel">Scalpel</a> for file carving if needed.</li>
                  <li>Check <span class="artifact-link" data-artifact="tmpshm">temp directories</span> for staged tools or payloads.</li>
                </ul>
              </div>
              <p class="helper">Start with a hypothesis if you have one; otherwise use the timeline to find anomalies.</p>
            </div>
          </article>

          <article class="guide-card" data-category="execution" data-keywords="browser history chrome firefox edge sqlite downloads">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="execution"></span>
                <div>
                  <h2>I have browser artifacts</h2>
                  <p class="helper">Reconstruct user browsing, downloads, and searches.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Key <span class="artifact-link" data-artifact="browser">browser</span> databases</h3>
                <ul class="guide-list">
                  <li><strong>History</strong> - URLs visited with timestamps and visit counts.</li>
                  <li><strong>Downloads</strong> - Files downloaded with source URLs and paths.</li>
                  <li><strong>Cache</strong> - Cached web content (images, scripts, pages).</li>
                  <li><strong>Cookies</strong> - Session tokens and site preferences.</li>
                  <li><strong>Autofill/Form data</strong> - Submitted form values.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Investigative focus areas</h3>
                <ol class="guide-list">
                  <li>Search history for reconnaissance or research related to the incident.</li>
                  <li>Download history to trace malware delivery or tool acquisition.</li>
                  <li>Webmail access indicating phishing or exfiltration via email.</li>
                  <li>Cloud storage access for staging or exfiltration evidence.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Windows locations</h3>
                <ul class="guide-list">
                  <li><strong>Chrome:</strong> AppData\Local\Google\Chrome\User Data\Default\</li>
                  <li><strong>Firefox:</strong> AppData\Roaming\Mozilla\Firefox\Profiles\</li>
                  <li><strong>Edge:</strong> AppData\Local\Microsoft\Edge\User Data\Default\</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Linux locations</h3>
                <ul class="guide-list">
                  <li><strong>Chrome:</strong> ~/.config/google-chrome/Default/</li>
                  <li><strong>Firefox:</strong> ~/.mozilla/firefox/*.default*/</li>
                  <li><strong>Chromium:</strong> ~/.config/chromium/Default/</li>
                </ul>
              </div>
              <p class="helper">Browser artifacts often show intent and are hard for users to fully clear.</p>
            </div>
          </article>

          <article class="guide-card" data-category="lateral" data-keywords="linux auth ssh sudo wtmp lastlog compromise">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="lateral"></span>
                <div>
                  <h2>I have Linux auth logs</h2>
                  <p class="helper">Analyze logins, SSH access, and privilege escalation.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Key <span class="artifact-link" data-artifact="authlogs">auth log</span> events</h3>
                <ul class="guide-list">
                  <li><strong>sshd</strong> - SSH login attempts with source IPs and usernames.</li>
                  <li><strong>sudo</strong> - Privilege escalation commands and outcomes.</li>
                  <li><strong>su</strong> - User switching activity.</li>
                  <li><strong>PAM</strong> - Authentication module events.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Investigative workflow</h3>
                <ol class="guide-list">
                  <li>Grep for "Accepted" to find successful SSH logins with source IPs.</li>
                  <li>Check for "Failed password" patterns indicating brute force attempts.</li>
                  <li>Review sudo commands to trace privilege escalation paths.</li>
                  <li>Correlate with <span class="artifact-link" data-artifact="wtmp">wtmp/btmp</span> for session durations.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Corroborating artifacts</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="bashhistory">Bash history</span> for commands run after login.</li>
                  <li><span class="artifact-link" data-artifact="sshkeys">SSH authorized_keys</span> for persistent access.</li>
                  <li><span class="artifact-link" data-artifact="journal">systemd journal</span> for additional context.</li>
                  <li><span class="artifact-link" data-artifact="passwdshadow">User accounts</span> for new or modified users.</li>
                </ul>
              </div>
              <p class="helper">Log rotation may limit history. Check for rotated logs (.1, .gz) and journal persistence.</p>
            </div>
          </article>

          <article class="guide-card" data-category="persistence" data-keywords="linux persistence cron systemd bashrc profile backdoor">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="persistence"></span>
                <div>
                  <h2>I have a Linux system to analyze</h2>
                  <p class="helper">Check persistence, user activity, and compromise indicators.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Persistence mechanisms</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="cron">Cron jobs</span> - /etc/crontab, /etc/cron.d/, user crontabs.</li>
                  <li><span class="artifact-link" data-artifact="systemdunits">Systemd units</span> - Services and timers in /etc/systemd/ and user directories.</li>
                  <li><span class="artifact-link" data-artifact="envfiles">Environment files</span> - .bashrc, .profile, /etc/profile.d/.</li>
                  <li><span class="artifact-link" data-artifact="sshkeys">SSH keys</span> - Authorized keys for persistent access.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>User activity</h3>
                <ol class="guide-list">
                  <li>Review <span class="artifact-link" data-artifact="bashhistory">Bash history</span> for all users including root.</li>
                  <li>Check <span class="artifact-link" data-artifact="authlogs">auth logs</span> for login patterns.</li>
                  <li>Examine <span class="artifact-link" data-artifact="tmpshm">/tmp and /dev/shm</span> for staged tools or payloads.</li>
                  <li>Review <span class="artifact-link" data-artifact="packages">package logs</span> for suspicious installs.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Quick wins for compromise detection</h3>
                <ul class="guide-list">
                  <li>New users in <span class="artifact-link" data-artifact="passwdshadow">/etc/passwd</span> or UID 0 accounts.</li>
                  <li><span class="artifact-link" data-artifact="etchosts">/etc/hosts</span> modifications for DNS hijacking.</li>
                  <li><span class="artifact-link" data-artifact="webserverlogs">Web server logs</span> if web-facing.</li>
                  <li><span class="artifact-link" data-artifact="auditd">Audit logs</span> if auditd was enabled.</li>
                </ul>
              </div>
              <p class="helper">Attackers often use multiple persistence mechanisms. Check them all.</p>
            </div>
          </article>

          <article class="guide-card" data-category="exfil" data-keywords="usb removable media thumb drive flash external storage device history setupapi">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="exfil"></span>
                <div>
                  <h2>I have USB/removable media artifacts</h2>
                  <p class="helper">Track device connections, file transfers, and user activity.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Windows USB device history sources</h3>
                <ul class="guide-list">
                  <li><strong>SYSTEM\CurrentControlSet\Enum\USBSTOR</strong> - Device class ID, vendor, product, serial number.</li>
                  <li><strong>SYSTEM\CurrentControlSet\Enum\USB</strong> - VID/PID pairs for device identification.</li>
                  <li><strong>SYSTEM\MountedDevices</strong> - Drive letter assignments to device signatures.</li>
                  <li><strong>SOFTWARE\Microsoft\Windows Portable Devices</strong> - Friendly names assigned to devices.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Connection timeline reconstruction</h3>
                <ol class="guide-list">
                  <li>Check <strong>setupapi.dev.log</strong> (Win7) or <strong>setupapi.dev.log</strong> (Win10+) for first and last connection times.</li>
                  <li>Review <span class="artifact-link" data-artifact="eventlogs">Event logs</span> System log for Event IDs 20001, 20003 (device install).</li>
                  <li>Cross-reference with <span class="artifact-link" data-artifact="lnk">LNK files</span> pointing to removable drive letters.</li>
                  <li>Check user registry (NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2) for user-specific connections.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>What was transferred?</h3>
                <ol class="guide-list">
                  <li>Look for <span class="artifact-link" data-artifact="lnk">LNK files</span> with target paths on removable drives (E:\, F:\, etc.).</li>
                  <li>Check <span class="artifact-link" data-artifact="shellbags">Shellbags</span> for folder browsing activity on the device.</li>
                  <li>Review <span class="artifact-link" data-artifact="jumplists">Jump Lists</span> for recently accessed files on removable media.</li>
                  <li>Examine <span class="artifact-link" data-artifact="mft">$MFT</span> for file copy operations (look for Zone.Identifier removal patterns).</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Linux USB tracking</h3>
                <ul class="guide-list">
                  <li><strong>/var/log/syslog</strong> or <strong>journal</strong> - USB device connection/disconnection events.</li>
                  <li><strong>dmesg</strong> - Kernel messages about device attachments.</li>
                  <li><strong>/var/log/auth.log</strong> - If USB storage triggers mount operations.</li>
                  <li><strong>/media/</strong> or <strong>/mnt/</strong> - Check for artifacts from mounted devices.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Evidence to corroborate</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> for file copy tools used during the transfer window.</li>
                  <li><span class="artifact-link" data-artifact="srum">SRUM</span> won't show USB directly but may show apps used during connection.</li>
                  <li>Physical security logs for device removal from secure areas.</li>
                  <li>If the device is recovered, forensically image it for complete file history.</li>
                </ul>
              </div>
              <p class="helper">USB artifacts persist even after the device is removed. The registry remembers every device ever connected.</p>
            </div>
          </article>

          <article class="guide-card" data-category="persistence" data-keywords="scheduled tasks task scheduler at schtasks xml persistence automation">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="persistence"></span>
                <div>
                  <h2>I have scheduled tasks to analyze</h2>
                  <p class="helper">Investigate task-based persistence and automated execution.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>Windows scheduled task locations</h3>
                <ul class="guide-list">
                  <li><strong>C:\Windows\System32\Tasks\</strong> - XML task definition files (primary location).</li>
                  <li><strong>C:\Windows\Tasks\</strong> - Legacy .job files (older systems).</li>
                  <li><strong>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache</strong> - Registry cache of tasks.</li>
                  <li><strong>SECURITY log Event ID 4698</strong> - Task creation audit events.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Suspicious task indicators</h3>
                <ul class="guide-list">
                  <li>Tasks with triggers at boot, logon, or idle (common persistence triggers).</li>
                  <li>Tasks running executables from temp folders, user directories, or unusual paths.</li>
                  <li>Tasks with encoded PowerShell commands or cmd.exe /c chains.</li>
                  <li>Tasks running as SYSTEM or with elevated privileges.</li>
                  <li>Recently created tasks (check registration date in XML).</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Task XML analysis</h3>
                <ol class="guide-list">
                  <li>Parse the <strong>RegistrationInfo</strong> section for creation date and author.</li>
                  <li>Check <strong>Triggers</strong> for activation conditions (boot, logon, time-based).</li>
                  <li>Examine <strong>Actions</strong> for the command line and arguments.</li>
                  <li>Review <strong>Principals</strong> for the security context (user/SYSTEM).</li>
                  <li>Look for hidden tasks (Hidden element set to true).</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Event log correlation</h3>
                <ul class="guide-list">
                  <li><strong>Security 4698</strong> - Scheduled task created (includes full XML).</li>
                  <li><strong>Security 4699</strong> - Scheduled task deleted.</li>
                  <li><strong>Security 4700/4701</strong> - Scheduled task enabled/disabled.</li>
                  <li><strong>Security 4702</strong> - Scheduled task updated.</li>
                  <li><strong>TaskScheduler/Operational</strong> - Detailed execution history.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Evidence to corroborate</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> for the executable the task runs.</li>
                  <li><span class="artifact-link" data-artifact="amcache">Amcache</span> for metadata on task payloads.</li>
                  <li><span class="artifact-link" data-artifact="mft">$MFT</span> for task file creation timestamp.</li>
                  <li>Correlate task creation time with initial compromise timeline.</li>
                </ul>
              </div>
              <p class="helper">Scheduled tasks are a favorite persistence mechanism. Check both the Tasks folder and registry cache.</p>
            </div>
          </article>

          <article class="guide-card" data-category="timeline" data-keywords="srum system resource usage monitor network application history bandwidth">
            <button class="guide-toggle" type="button" aria-haspopup="dialog">
              <div class="guide-toggle-content">
                <span class="guide-icon" data-category="timeline"></span>
                <div>
                  <h2>I have SRUM data</h2>
                  <p class="helper">Analyze historical application and network usage patterns.</p>
                </div>
              </div>
              <span class="toggle-icon chevron">&gt;</span>
            </button>
            <div class="guide-body">
              <div class="guide-section">
                <h3>What is <span class="artifact-link" data-artifact="srum">SRUM</span>?</h3>
                <ul class="guide-list">
                  <li>System Resource Usage Monitor - Windows 8+ artifact tracking resource consumption.</li>
                  <li>Location: <strong>C:\Windows\System32\sru\SRUDB.dat</strong> (ESE database).</li>
                  <li>Retains data for 30-60 days depending on system activity.</li>
                  <li>Survives application uninstallation - records persist after software removal.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Key SRUM tables</h3>
                <ul class="guide-list">
                  <li><strong>Network Data Usage</strong> - Bytes sent/received per application with interface info.</li>
                  <li><strong>Network Connectivity</strong> - Network profiles connected and duration.</li>
                  <li><strong>Application Resource Usage</strong> - CPU time, foreground/background cycles per app.</li>
                  <li><strong>Push Notifications</strong> - WNS notification activity per application.</li>
                  <li><strong>Energy Usage</strong> - Battery and power consumption data.</li>
                </ul>
              </div>
              <div class="guide-section">
                <h3>Investigative applications</h3>
                <ol class="guide-list">
                  <li><strong>Exfiltration detection:</strong> Look for applications with high bytes-sent during suspect timeframes.</li>
                  <li><strong>Malware activity:</strong> Identify unknown executables with network activity.</li>
                  <li><strong>Deleted evidence:</strong> Find traces of uninstalled malware or tools.</li>
                  <li><strong>Timeline reconstruction:</strong> Correlate app usage with other artifact timestamps.</li>
                  <li><strong>Lateral movement:</strong> Identify remote admin tool usage and network connections.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Analysis workflow</h3>
                <ol class="guide-list">
                  <li>Copy SRUDB.dat (may need to stop the DiagTrack service or copy from image).</li>
                  <li>Parse with tools like SRUM-DUMP, NirSoft SrumECmd, or ESEDatabaseView.</li>
                  <li>Cross-reference application SIDs with user accounts.</li>
                  <li>Sort by bytes sent to find potential exfiltration applications.</li>
                  <li>Look for executables running from temp folders or unusual paths.</li>
                </ol>
              </div>
              <div class="guide-section">
                <h3>Evidence to corroborate</h3>
                <ul class="guide-list">
                  <li><span class="artifact-link" data-artifact="prefetch">Prefetch</span> to confirm application execution.</li>
                  <li><span class="artifact-link" data-artifact="amcache">Amcache</span> for application metadata and hashes.</li>
                  <li>Network logs or firewall data to validate connection destinations.</li>
                  <li><span class="artifact-link" data-artifact="mft">$MFT</span> to find the actual executable files.</li>
                </ul>
              </div>
              <p class="helper">SRUM is a goldmine for historical activity. Even deleted malware leaves traces here.</p>
            </div>
          </article>
        </section>
      </main>

    </div>

    <div class="guide-modal" id="guideModal" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="guide-modal-backdrop" data-guide-close></div>
      <div class="guide-modal-surface" role="document">
        <div class="guide-modal-header">
          <div class="guide-modal-title">
            <span class="guide-pill" id="guideModalCategory" data-category="info">Guide</span>
            <h2 id="guideModalTitle"></h2>
            <p class="helper" id="guideModalSummary"></p>
          </div>
          <button class="ghost" id="guideModalClose" type="button">Close</button>
        </div>
        <div class="guide-modal-body" id="guideModalBody"></div>
      </div>
    </div>

    {% from "_components.html" import glossary_sidebar, guides_sidebar, active_jobs_drawer %}
    {{ glossary_sidebar() }}
    {{ guides_sidebar() }}
    {{ active_jobs_drawer() }}
    <footer></footer>
    <script defer src="{{ url_for('static', filename='app.js') }}"></script>
    <script defer src="{{ url_for('static', filename='glossary.js') }}"></script>
    <script defer src="{{ url_for('static', filename='guides.js') }}"></script>
    <script defer src="{{ url_for('static', filename='guides-sidebar.js') }}"></script>
  </body>
</html>
